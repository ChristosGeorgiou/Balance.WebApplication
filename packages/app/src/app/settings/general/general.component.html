<app-content [box]="true">
  <section role="title">General Options</section>
  <section>
    <h4>Workspace</h4>
    <div class="form-group input-group">
      <div class="input-group-prepend">
        <span class="input-group-text">Workspace Name</span>
      </div>
      <input #name [value]="workspace.name" class="form-control">
      <div class="input-group-append">
        <button class="btn btn-primary" (click)="workspace.name = name.value; saveWorkspace()">Update</button>
      </div>
    </div>
    <small class="text-muted">Don't change this unless you know what are you doing.</small>
  </section>
  <section>
    <h4>Users</h4>
    <div>All user accounts are available for switching</div>

    <table class="table">
      <ng-container *ngIf="(users$ |async) as users">
        <ng-container *ngFor="let user of users">
          <tr>
            <td>{{user.username}} <span *ngIf="user.owner">owner</span></td>
            <td style="width:100px">
              <button *ngIf="user.username === username" class="btn btn-outline-primary btn-sm" (click)="switchUser(username)">switch</button>
            </td>
          </tr>
        </ng-container>
      </ng-container>
    </table>

    <h4>Create New User</h4>
    <div class="form-group input-group">
      <div class="input-group-prepend">
        <span class="input-group-text">Username</span>
      </div>
      <input #newUserUsername class="form-control">
      <div class="input-group-append">
        <button class="btn btn-primary" (click)="createUser(newUserUsername)">Create</button>
      </div>
    </div>
  </section>
  <section>
    <h4>Layout & Theme</h4>
    <div class="form-group">
      <label class="mr-2">Content Layout:</label>
      <div class="custom-control custom-radio custom-control-inline">
        <input type="radio" id="layout_fluid" name="layout" (change)="saveUserConfig()" [(ngModel)]="user.config.layout"
          value="fluid" class="custom-control-input">
        <label class="custom-control-label" for="layout_fluid">Fluid</label>
      </div>
      <div class="custom-control custom-radio custom-control-inline">
        <input type="radio" id="layout_box" name="layout" (change)="saveUserConfig()" [(ngModel)]="user.config.layout"
          value="box" class="custom-control-input">
        <label class="custom-control-label" for="layout_box">Box</label>
      </div>
    </div>
    <div class="form-group">
      <label class="mr-2">Menu Size:</label>
      <div class="custom-control custom-radio custom-control-inline">
        <input type="radio" id="menu_size_compact" name="menu_size" (change)="saveUserConfig()"
          [(ngModel)]="user.config.menu.size" value="compact" class="custom-control-input">
        <label class="custom-control-label" for="menu_size_compact">Compact</label>
      </div>
      <div class="custom-control custom-radio custom-control-inline">
        <input type="radio" id="menu_size_normal" name="menu_size" (change)="saveUserConfig()"
          [(ngModel)]="user.config.menu.size" value="normal" class="custom-control-input">
        <label class="custom-control-label" for="menu_size_normal">Normal</label>
      </div>
    </div>
    <div class="form-group">
      <label class="mr-2">Show Menu Items:</label>
      <div class="row">
        <ng-container *ngFor="let item of menu">
          <div class="col-md-3">
            <div class="custom-control custom-checkbox custom-control-inline">
              <input type="checkbox" class="custom-control-input" id="{{'menuItem'+item.label}}" (change)="saveUserConfig()"
                [(ngModel)]="showMenuItems[item.label]">
              <label class="custom-control-label" for="{{'menuItem'+item.label}}">{{item.label}}</label>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </section>
  <section>
    <h4>Export</h4>
    <p>
      Export this workspace for import in another machine. <strong>This do not backup your data.</strong>
    </p>
    <button class="btn btn-primary" (click)="export()">Export to file</button>
  </section>
  <section>
    <h4>Telemetry</h4>
    <div class="mb-3">
      <div>When an error is occured, a debug event is send to <a target="_blank" href="https://sentry.io">sentry.io</a>.
        This will
        help further development as we may resolve issues faster.</div>
      <div class="custom-control custom-checkbox custom-control-inline">
        <input id="errorReport" [(ngModel)]="workspace.config.errors" (change)="saveUserConfig()" class="custom-control-input"
          type="checkbox">
        <label for="errorReport" class="custom-control-label">
          Send debug error data</label>
      </div>
    </div>
    <div class="mb-3">
      <div>Analytics help us to better understand how blanc have been used, so we may improve it. We use
        <a target="_blank" href="https://woopra.com">woopra.com</a> for this.</div>
      <div class="custom-control custom-checkbox custom-control-inline">
        <input id="analytics" [(ngModel)]="workspace.config.analytics" (change)="saveUserConfig()" class="custom-control-input"
          type="checkbox">
        <label for="analytics" class="custom-control-label">
          Send analytics data</label>
      </div>
    </div>
  </section>
  <section>
    <h4 class="text-danger">Danger Zone</h4>
    <p>
      Deleting your workspace, you immediately remove all local data. If you would like also
      to delete the remote data please check the appropriate option below. If you do not delete remote data, all
      data will be synced once again if workspace is recreated or imported.
    </p>
    <div class="form-group form-check">
      <input type="checkbox" class="form-check-input" id="deleteData" [(ngModel)]="deleteData">
      <label class="form-check-label" for="deleteData">Î™ understand that this is not reversable</label>
    </div>
    <div class="form-group form-check">
      <input type="checkbox" class="form-check-input" id="deleteDataRemote" [(ngModel)]="deleteDataRemote">
      <label class="form-check-label" for="deleteDataRemote">Also delete remote data</label>
    </div>
    <button class="btn btn-danger" [disabled]="!deleteData" (click)="delete()">
      Remove Workspace
    </button>
  </section>
</app-content>
<ng-template #loading>
  <app-spinner></app-spinner>
</ng-template>
