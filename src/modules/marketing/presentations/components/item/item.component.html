<div class="loader" *ngIf="!presentation"></div>
<div class="content d-flex flex-column justify-content-start" *ngIf="presentation">
  <app-content-header [title]="(presentation.title || '-')" [icon]="'desktop'" [settingsMenu]="settingsMenu"></app-content-header>
  <div class="content-body">
    <div class="container">
      <div class="row">

        <div class="col-md-4">
          <div class="card mb-2">
            <div class="card-body">
              <dl>
                <dt>Description
                  <a href="javascript:void(0)" class="descCollToggle" (click)="descOpen = !descOpen">
                    <span *ngIf="descOpen">
                      <span class="fa fa-angle-double-up"></span> LESS
                    </span>
                    <span *ngIf="!descOpen">
                      <span class="fa fa-angle-double-down"></span> MORE
                    </span>
                  </a>
                </dt>
                <dd class="descColl" [ngClass]="{'open':descOpen}">
                  {{presentation.description}}
                </dd>
                <dt>Statistics</dt>
                <dd>
                  <ul class="list-unstyled">
                    <li>Version
                      <strong>{{statistics.docVersion}}</strong>
                    </li>
                    <li>Total
                      <strong>{{presentation.pages.length}}</strong> pages
                    </li>
                    <li>Total
                      <strong>{{statistics.totalFilesCount}}</strong> files of
                      <strong>{{statistics.totalFilesBytesize | bytes}}</strong> size
                    </li>
                  </ul>
                </dd>
              </dl>
            </div>
            <div class="card-header">
              Pages
              <div class="card-header-buttons">
                <button class="btn btn-outline-primary" (click)="addPage()">
                  <span class="fa fa-plus fa-fw"></span> Add
                </button>
              </div>
            </div>

            <app-empty-panel class="m-0" *ngIf="!presentation.pages.length" message="No pages were found"></app-empty-panel>

            <div class="list-group list-group-flush" style="height: 230px;overflow-y:scroll" *ngIf="presentation.pages.length">
              <a href="javascript:void(0)" [ngClass]="{'active': activePageIndex==i}" (click)="setPageIndex(i)" class="list-group-item p-2"
                *ngFor="let page of presentation.pages; let i = index;">
                {{page.title}}
                <small class="pull-right">#{{i+1}}</small>
              </a>
            </div>
          </div>
        </div>

        <div class="col-md-8">

          <app-empty-panel *ngIf="!presentation.pages.length" message="No pages were found"></app-empty-panel>

          <div *ngIf="presentation.pages">
            <div class="card" *ngIf="presentation.pages[activePageIndex]">
              <div class="card-header">
                {{presentation.pages[activePageIndex].title}}
                <small class="text-secondary">#{{activePageIndex+1}}</small>
                <div class="card-header-buttons">
                  <div ngbDropdown placement="bottom-right" class="d-inline-block">
                    <button class="btn btn-link text-secondary dropdown-toggle-hidden" ngbDropdownToggle>
                      <span class="fa fa-bars"></span>
                    </button>
                    <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                      <button class="dropdown-item text-danger" (click)="deletePage(activePageIndex)">
                        <span class="fa fa-trash-o"></span> Delete
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div *ngIf="presentation.pages[activePageIndex].type=='BGIMG' && imageData">
                <img class="img-fluid" [src]="imageData">
              </div>
              <div class="card-body" *ngIf="presentation.pages[activePageIndex].description">
                {{presentation.pages[activePageIndex].description}}
              </div>
            </div>
          </div>
        </div>
      </div>
      <pre>{{presentation|json:2}}</pre>
    </div>
  </div>
</div>
