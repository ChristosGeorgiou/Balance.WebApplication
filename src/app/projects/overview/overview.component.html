<app-content>
  <div class="bg-light">
    <div class="container">
      <ol class="breadcrumb mb-0 bg-light">
        <li class="breadcrumb-item active">Overview</li>
      </ol>
    </div>
  </div>
  <app-content-body>
    <div class="btn-toolbar">
      <div>Show</div>
      <select class="form-control form-control-sm mx-2" style="width: 60px" [(ngModel)]="pLength"
        (change)="calcPages()">
        <option *ngFor="let length of lengths" [ngValue]="length">{{length}}</option>
      </select>
      <div>issues</div>
      <div class="ml-auto">
        <ul class="pagination pagination-sm mb-0">
          <li class="page-item">
            <button class="page-link" (click)="goPrevious()">Previous</button>
          </li>
          <li class="page-item" [ngClass]="{active:p === page}" *ngFor="let p of pages">
            <button class="page-link" (click)="page = p">{{p+1}}</button>
          </li>
          <li class="page-item">
            <button class="page-link" (click)="goNext()">Next</button>
          </li>
        </ul>
      </div>
    </div>

    <ng-container *ngIf="(issues$ | async) as issues; else loader">
      <ng-container *ngIf="issues.length; else noissues">
        <table class="table table-sm">
          <thead>
            <tr>
              <th style="width:100px">Status</th>
              <th>Issue</th>
              <th>Details</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let issue of issues | slice:pStart:pEnd">
              <td>
                <span class="badge badge-dark w-100"
                  [ngStyle]="{'background-color':getStatus(issue.status).color}">{{getStatus(issue.status).alias}}</span>
              </td>
              <td>
                <a [routerLink]="['/projects/project',issue.project,'issue',issue['_id']]">{{issue.title}}</a>
                <small> / <a
                    [routerLink]="['/projects/project',issue.projectId]">{{getProject(issue.projectId).name}}</a></small>
              </td>
              <td>
                {{issue.insertedAt | dfnsDistanceInWordsToNow}} ago by
                {{issue.insertedFrom}}
              </td>
            </tr>
          </tbody>
        </table>
      </ng-container>
    </ng-container>

  </app-content-body>

</app-content>

<ng-template #noissues>
  <app-empty message="You don't have any events yet" icon="file-alt:regular"></app-empty>
</ng-template>
<ng-template #loader>
  <app-spinner></app-spinner>
</ng-template>